(self.webpackChunkspear=self.webpackChunkspear||[]).push([[3907,1413,6152],{69188:(G,x)=>{function Z(s){return s.replace(/[-[\]/{}()*+?.\\^$]/g,"\\$&")}function g(s,t){var h=(void 0===t?{}:t).decimalMark,a=void 0===h?".":h;if("number"==typeof s)return s.toString();if("string"!=typeof s)return"NaN";var w=Z(a),y=s.trim(),O=y.match(/^\(.*\)$|^-/),k=new RegExp("[^\\d"+w+"]|"+w+"(?=.*"+w+")|^\\D*"+w+"\\D*$","g");return""===(y=y.replace(k,"").replace(a,"."))?y="NaN":O&&(y="-"+y),y}x.He=void 0,x.He=function A(s,t){var h=(void 0===t?{}:t).decimalMark,w=g(s,{decimalMark:void 0===h?".":h});return"NaN"===w?NaN:Number(w)}},3907:(G,x,d)=>{d.r(x),d.d(x,{ATTRIBUTE_WIDGET:()=>F,Attribute:()=>z,AttributeMatcherService:()=>j,AttributePipe:()=>Q,AttributeSerializerService:()=>q,AttributeTypes:()=>l,AttributeValue:()=>I,AttributeWidget:()=>K,AttributeWidgetComponent:()=>V,AttributesBuilderComponent:()=>C,AttributesModule:()=>Y,ValueComputerService:()=>H,WidgetPluginManager:()=>T,WidgetsService:()=>S});var Z=d(4942),g=d(1413),A=d(74902),v=d(60136),M=d(18486),f=d(15671),s=d(43144),t=d(56718),m=d(94055),h=d(3267),a=d(47405),w=d(69490),y=d(39646),O=d(25813),k=d(8154),U=d(30972),D=d(26073),R=d(69188);function P(n,i){}function p(n,i){if(1&n&&(t.\u0275\u0275elementStart(0,"div",4),t.\u0275\u0275element(1,"classifieds-ui-attribute-widget",5),t.\u0275\u0275elementEnd()),2&n){var r=i.index,e=t.\u0275\u0275nextContext();t.\u0275\u0275propertyInterpolate("formGroupName",r),t.\u0275\u0275advance(1),t.\u0275\u0275property("attribute",e.attributes[r])("widget",e.discoverWidget(e.attributes[r].widget))("appearance",e.appearance)}}function N(n,i){1&n&&(t.\u0275\u0275elementStart(0,"div")(1,"p"),t.\u0275\u0275text(2,"No attributes available for ad type. Click next to continue."),t.\u0275\u0275elementEnd()())}var F=new t.InjectionToken("AttributeWidget"),S=function(){var n=function(){function i(r){(0,f.Z)(this,i),this.widgets=r}return(0,s.Z)(i,[{key:"get",value:function(e){return this.widgets.find(function(o){return o.name===e})}}]),i}();return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(F))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),T=function(){var n=function(i){(0,v.Z)(e,i);var r=(0,M.Z)(e);function e(o,u){return(0,f.Z)(this,e),r.call(this,o,u)}return(0,s.Z)(e,[{key:"pluginDef",value:function(){return(0,y.of)(new O.PluginDef({name:"widget"}))}}]),e}(O.BasePluginManager);return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(O.PluginConfigurationManager),t.\u0275\u0275inject(k.ModuleLoaderService))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),b=function(){var n=(0,s.Z)(function i(r){(0,f.Z)(this,i),this.viewContainerRef=r});return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(t.ViewContainerRef))},n.\u0275dir=t.\u0275\u0275defineDirective({type:n,selectors:[["","classifiedsUiWidgetHost",""]]}),n}(),V=function(){var n=function(){function i(r,e){(0,f.Z)(this,i),this.componentFactoryResolver=r,this.controlContainer=e,this.appearance="legacy"}return(0,s.Z)(i,[{key:"ngOnInit",value:function(){var e=this;this.widget.subscribe(function(o){var u=e.componentFactoryResolver.resolveComponentFactory(o.component),c=e.widgetHost.viewContainerRef;c.clear();var _=c.createComponent(u);_.instance.attribute=e.attribute,_.instance.appearance=e.appearance})}}]),i}();return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(t.ComponentFactoryResolver),t.\u0275\u0275directiveInject(a.ControlContainer))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-attribute-widget"]],viewQuery:function(r,e){var o;1&r&&t.\u0275\u0275viewQuery(b,7),2&r&&t.\u0275\u0275queryRefresh(o=t.\u0275\u0275loadQuery())&&(e.widgetHost=o.first)},inputs:{widget:"widget",attribute:"attribute",appearance:"appearance"},decls:2,vars:1,consts:[[3,"formGroup"],["classifiedsUiWidgetHost",""]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275template(1,P,0,0,"ng-template",1),t.\u0275\u0275elementContainerEnd()),2&r&&t.\u0275\u0275property("formGroup",e.controlContainer.control)},dependencies:[a.NgControlStatusGroup,a.FormGroupDirective,b]}),n}(),C=function(){var n=function(){function i(r,e){(0,f.Z)(this,i),this.widgetsService=r,this.wpm=e,this.attributes=[],this.appearance="legacy",this.attributesForm=new a.UntypedFormGroup({attributes:new a.UntypedFormArray([])}),this._attributeValues=[],this.onTouched=function(){}}return(0,s.Z)(i,[{key:"attributeValues",get:function(){return this._attributeValues},set:function(e){this._attributeValues=e,this.applyValues()}},{key:"attributesArray",get:function(){return this.attributesForm.get("attributes")}},{key:"ngOnChanges",value:function(e){var o=this;if(e.attributes&&(!e.attributes.previousValue||e.attributes.previousValue!==e.attributes.currentValue)){for(;0!==this.attributesArray.length;)this.attributesArray.removeAt(0);this.attributes.forEach(function(u){o.attributesArray.push(new a.UntypedFormGroup({name:new a.UntypedFormControl(u.name,a.Validators.required),type:new a.UntypedFormControl(u.type,a.Validators.required),displayName:new a.UntypedFormControl(u.label,a.Validators.required),value:new a.UntypedFormControl("",u.required?a.Validators.required:[]),attributes:new a.UntypedFormArray(u.attributes?u.attributes.map(function(c){return new a.UntypedFormGroup({name:new a.UntypedFormControl(c.name,a.Validators.required),type:new a.UntypedFormControl(c.type,a.Validators.required),displayName:new a.UntypedFormControl(c.label,a.Validators.required),value:new a.UntypedFormControl("",c.required?a.Validators.required:[])})}):[])}))}),this.applyValues()}}},{key:"writeValue",value:function(e){e&&(console.log("write value: ".concat(e)),this.attributesArray.setValue(e,{emitEvent:!1}))}},{key:"registerOnChange",value:function(e){this.attributesArray.valueChanges.subscribe(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){e?this.attributesArray.disable():this.attributesArray.enable()}},{key:"validate",value:function(e){return this.attributesForm.valid?null:{invalidForm:{valid:!1,message:"attributes are invalid"}}}},{key:"discoverWidget",value:function(e){return this.wpm.getPlugin(e)}},{key:"applyValues",value:function(){var e=this;this.attributesArray.controls.forEach(function(o,u){var c=e.attributeValues?e.attributeValues.find(function(_){return _.name===o.get("name").value}):void 0;void 0!==c&&(o.get("value").setValue(c.value),o.updateValueAndValidity()),o.get("attributes").controls.forEach(function(_){var E=e.attributeValues&&void 0!==e.attributeValues[u]?e.attributeValues[u].attributes.find(function(W){return W.name===_.get("name").value}):void 0;void 0!==E&&(_.get("value").setValue(E.value),_.updateValueAndValidity())})})}}]),i}();return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(S),t.\u0275\u0275directiveInject(T))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-attributes-builder"]],inputs:{attributes:"attributes",appearance:"appearance",attributeValues:"attributeValues"},features:[t.\u0275\u0275ProvidersFeature([S,{provide:a.NG_VALUE_ACCESSOR,useExisting:(0,t.forwardRef)(function(){return n}),multi:!0},{provide:a.NG_VALIDATORS,useExisting:(0,t.forwardRef)(function(){return n}),multi:!0}]),t.\u0275\u0275NgOnChangesFeature],decls:4,vars:3,consts:[[3,"formGroup"],["formArrayName","attributes",1,"attribute-fields"],["class","attribute-field-container",3,"formGroupName",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"attribute-field-container",3,"formGroupName"],[3,"attribute","widget","appearance"]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275elementStart(1,"div",1),t.\u0275\u0275template(2,p,2,4,"div",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275template(3,N,3,0,"div",3)),2&r&&(t.\u0275\u0275property("formGroup",e.attributesForm),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.attributesArray.controls),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",0==e.attributes.length))},dependencies:[m.NgForOf,m.NgIf,a.NgControlStatusGroup,a.FormGroupDirective,a.FormGroupName,a.FormArrayName,V]}),n}(),B=function(){var n=(0,s.Z)(function i(r){(0,f.Z)(this,i),this.controlContainer=r,this.appearance="legacy"});return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(a.ControlContainer))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-text-widget"]],inputs:{attribute:"attribute",appearance:"appearance"},decls:3,vars:3,consts:[[3,"formGroup"],[3,"appearance"],["matInput","","formControlName","value",3,"placeholder"]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275elementStart(1,"mat-form-field",1),t.\u0275\u0275element(2,"input",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&r&&(t.\u0275\u0275property("formGroup",e.controlContainer.control),t.\u0275\u0275advance(1),t.\u0275\u0275property("appearance",e.appearance),t.\u0275\u0275advance(1),t.\u0275\u0275property("placeholder",e.attribute.label))},dependencies:[a.DefaultValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,U.MatLegacyFormField,D.MatLegacyInput]}),n}(),L=function(){var n=(0,s.Z)(function i(r){(0,f.Z)(this,i),this.controlContainer=r});return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(a.ControlContainer))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["classifieds-ui-min-max-widget"]],inputs:{attribute:"attribute"},decls:8,vars:4,consts:[[3,"formGroup"],["formArrayName","attributes"],["formGroupName","0"],["matInput","","type","number","formControlName","value",3,"placeholder"],["formGroupName","1"]],template:function(r,e){1&r&&(t.\u0275\u0275elementContainerStart(0,0),t.\u0275\u0275elementStart(1,"label"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"div",1)(4,"mat-form-field",2),t.\u0275\u0275element(5,"input",3),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"mat-form-field",4),t.\u0275\u0275element(7,"input",3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&r&&(t.\u0275\u0275property("formGroup",e.controlContainer.control),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.attribute.label),t.\u0275\u0275advance(3),t.\u0275\u0275property("placeholder",e.attribute.attributes[0].label),t.\u0275\u0275advance(2),t.\u0275\u0275property("placeholder",e.attribute.attributes[1].label))},dependencies:[a.DefaultValueAccessor,a.NumberValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,a.FormGroupName,a.FormArrayName,U.MatLegacyFormField,D.MatLegacyInput]}),n}(),j=function(){var n=function(){function i(){(0,f.Z)(this,i)}return(0,s.Z)(i,[{key:"getComputedValue",value:function(e,o){var u=o&&o.length>0&&this.matchAttribute(e,o);if(u)return u.computedValue}},{key:"getValue",value:function(e,o){var u=o&&o.length>0&&this.matchAttribute(e,o);if(u)return u.value}},{key:"matchAttribute",value:function(e,o){for(var u=o.length,c=0;c<u;c++)if(o[c].attributes&&o[c].attributes.length>0){if(this.matchAttribute(e,o[c].attributes))return o[c]}else if(e===o[c].name)return o[c]}}]),i}();return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),Q=function(){var n=function(){function i(r){(0,f.Z)(this,i),this.attributeMatcher=r}return(0,s.Z)(i,[{key:"transform",value:function(e,o){return this.attributeMatcher.getComputedValue(o,e)||""}}]),i}();return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(j,16))},n.\u0275pipe=t.\u0275\u0275definePipe({name:"attribute",type:n,pure:!0}),n}(),l=function(){return(l=l||{})[l.Number=0]="Number",l[l.Text=1]="Text",l[l.Complex=2]="Complex",l[l.Float=3]="Float",l[l.Array=4]="Array",l[l.Bool=5]="Bool",l[l.Date=6]="Date",l}(),K=function(n){(0,v.Z)(r,n);var i=(0,M.Z)(r);function r(e){var o;return(0,f.Z)(this,r),o=i.call(this,e),e&&(o.name=o.id,o.schema=e.schema?new z(e.schema):void 0,o.component=e.component),o}return(0,s.Z)(r)}(O.Plugin),z=(0,s.Z)(function n(i){(0,f.Z)(this,n),this.attributes=[],i&&(this.name=i.name,this.widget=void 0!==i.widget?i.widget:"text",this.type=i.type,this.label=i.label,this.required=i.required,this.options=i.options,i.attributes&&(this.attributes=i.attributes.map(function(r){return new n(r)})))}),I=(0,s.Z)(function n(i){(0,f.Z)(this,n),this.attributes=[],i&&(this.name=i.name,this.displayName=i.displayName,this.type=i.type,this.value=i.value,this.intValue=i.intValue,this.computedValue=i.computedValue,i.attributes&&(Array.isArray(i.attributes)?this.attributes=i.attributes.reduce(function(r,e){return void 0===e._store||e._store?[].concat((0,A.Z)(r),[new n(e)]):r},[]):(void 0===i.attributes._store||i.attributes._store)&&(this.attributes=[i.attributes])),i.value&&"object"==typeof i.value?(this.value=void 0,this.type=l.Complex,i.value.attributes.reduce(function(r,e){return void 0===e._store||e._store?[].concat((0,A.Z)(r),[new n(e)]):r},[])):this.value=i.value)}),J=function(){var i=new z({name:"",type:l.Text,label:"",required:!1,widget:"text",options:{},attributes:[]});return new K({id:"text",name:"text",title:"Text",component:B,schema:i})},X=function(){return new K({id:"minmax",name:"minmax",title:"MinMax",component:L,schema:void 0})},Y=function(){var n=(0,s.Z)(function i(r,e){(0,f.Z)(this,i),r.forEach(function(o){return e.register(o)})});return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(F),t.\u0275\u0275inject(T))},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({providers:[{provide:F,useFactory:J,multi:!0},{provide:F,useFactory:X,multi:!0}],imports:[m.CommonModule,a.ReactiveFormsModule,w.MaterialModule,h.HttpClientJsonpModule]}),n}(),H=function(){var n=function(){function i(){(0,f.Z)(this,i)}return(0,s.Z)(i,[{key:"compute",value:function(e){var o=this,u=[];return e.forEach(function(c){return u.push(o.computeAttribute(c))}),u}},{key:"computeAttribute",value:function(e){var o=this.resolveComputedValue(e.value,e.type);return new I((0,g.Z)((0,g.Z)({},e),{},e.attributes&&e.attributes.length>0?{computedValue:o,attributes:this.compute(e.attributes)}:{computedValue:o}))}},{key:"resolveComputedValue",value:function(e,o){var u;return o===l.Number?(u=(0,R.He)(e.trim()))&&isNaN(u)&&(u=void 0):u=e.trim(),void 0===u?u:"".concat(u)}}]),i}();return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),q=function(){var n=function(){function i(r){(0,f.Z)(this,i),this.valueComputer=r}return(0,s.Z)(i,[{key:"serialize",value:function(e,o){var u=typeof e;if("object"!==u)return new I({name:o,type:"string"!==u?"boolean"!==u?l.Number:l.Bool:l.Text,displayName:o,value:"".concat(e),intValue:void 0,computedValue:this.valueComputer.resolveComputedValue("".concat(e),"string"!==u?"boolean"!==u?l.Number:l.Bool:l.Text),attributes:[]});if(Array.isArray(e)&&("attributes"===o||"settings"===o))return new I({name:o,type:l.Complex,displayName:o,value:void 0,intValue:void 0,computedValue:void 0,attributes:e});if(Array.isArray(e)){for(var c=e.length,_=[],E=0;E<c;E++)_.push(this.serialize(e[E],"".concat(E)));return new I({name:o,type:l.Array,displayName:o,value:void 0,intValue:void 0,computedValue:void 0,attributes:_})}if(e instanceof Date)return new I({name:o,type:l.Date,displayName:o,value:e.toJSON(),intValue:void 0,computedValue:e.toJSON(),attributes:[]});var W=[];for(var $ in e)W.push(this.serialize(e[$],$));return new I({name:o,type:l.Complex,displayName:o,value:void 0,intValue:void 0,computedValue:void 0,attributes:W})}},{key:"deserializeAsObject",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.deserialize(new I({name:"root",type:l.Complex,displayName:"root",value:void 0,computedValue:void 0,intValue:0,attributes:e}),o)}},{key:"deserialize",value:function(e){var u,c,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e.type){case l.Complex:if(o||"attributes"!==e.name&&"settings"!==e.name){c=e.attributes.length;for(var _=0;_<c;_++)u=(0,g.Z)((0,g.Z)({},u),{},(0,Z.Z)({},e.attributes[_].name,this.deserialize(e.attributes[_])))}else u=e.attributes.map(function(W){return new I(W)});break;case l.Bool:u=void 0!==e.value?["1","true","on"].findIndex(function(W){return W===e.value})>-1:void 0;break;case l.Number:case l.Float:u=void 0!==e.value&&""!==e.value&&"undefined"!==e.value?"0"!==e.value?(0,R.He)(e.value.trim()):0:void 0;break;case l.Text:u=e.value;break;case l.Array:if(o||"attributes"!==e.name&&"settings"!==e.name){c=e.attributes.length,u=[];for(var E=0;E<c;E++)u=[].concat((0,A.Z)(u),[this.deserialize(e.attributes[E])])}else u=e.attributes.map(function(W){return new I(W)});break;case l.Date:u=void 0!==e.value&&""!==e.value?new Date(e.value):void 0}return u}},{key:"convertToGroup",value:function(e){var o=this,u=new a.UntypedFormGroup({name:new a.UntypedFormControl(e.name,a.Validators.required),type:new a.UntypedFormControl(e.type,a.Validators.required),displayName:new a.UntypedFormControl(e.displayName,a.Validators.required),value:new a.UntypedFormControl(e.value,a.Validators.required),computedValue:new a.UntypedFormControl(e.value,a.Validators.required),attributes:new a.UntypedFormArray([])});return e.attributes&&e.attributes.length>0&&e.attributes.forEach(function(c){u.get("attributes").push(o.convertToGroup(c))}),u}}]),i}();return n.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(H))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()},4942:(G,x,d)=>{d.d(x,{Z:()=>g});var Z=d(83997);function g(A,v,M){return(v=(0,Z.Z)(v))in A?Object.defineProperty(A,v,{value:M,enumerable:!0,configurable:!0,writable:!0}):A[v]=M,A}},1413:(G,x,d)=>{d.d(x,{Z:()=>A});var Z=d(4942);function g(v,M){var f=Object.keys(v);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(v);M&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(v,t).enumerable})),f.push.apply(f,s)}return f}function A(v){for(var M=1;M<arguments.length;M++){var f=null!=arguments[M]?arguments[M]:{};M%2?g(Object(f),!0).forEach(function(s){(0,Z.Z)(v,s,f[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(f)):g(Object(f)).forEach(function(s){Object.defineProperty(v,s,Object.getOwnPropertyDescriptor(f,s))})}return v}}}]);